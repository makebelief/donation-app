import{S as Ne,i as je,s as qe,n as ge,d,q as Be,z as ze,B as Se,A as ue,b as q,c as r,y as ee,C as Oe,e as s,f as u,g as y,k as D,j as M,J as Ee,l as c,m as P,h as Ae,t as He,a as Fe,Q as me,R as be}from"../chunks/BUL126xa.js";import{e as Ie}from"../chunks/D6YF6ztN.js";import"../chunks/IHki7fMi.js";import{g as Re}from"../chunks/D0Z6Z9IO.js";function Te(a,e,t){const l=a.slice();return l[16]=e[t],l}function De(a){let e,t=a[16].label+"",l,i,f,g,o;function p(){return a[11](a[16])}return{c(){e=c("button"),l=He(t),i=P(),this.h()},l(k){e=u(k,"BUTTON",{type:!0,class:!0});var m=y(e);l=Ae(m,t),i=M(m),m.forEach(d),this.h()},h(){s(e,"type","button"),s(e,"class",f="relative h-12 rounded-xl text-center transition-all duration-200 "+(a[3]===a[16].value.toString()?"bg-blue-600 text-white font-medium shadow-lg scale-105":"bg-gray-50 text-gray-600 hover:bg-gray-100"))},m(k,m){q(k,e,m),r(e,l),r(e,i),g||(o=ee(e,"click",p),g=!0)},p(k,m){a=k,m&8&&f!==(f="relative h-12 rounded-xl text-center transition-all duration-200 "+(a[3]===a[16].value.toString()?"bg-blue-600 text-white font-medium shadow-lg scale-105":"bg-gray-50 text-gray-600 hover:bg-gray-100"))&&s(e,"class",f)},d(k){k&&d(e),g=!1,o()}}}function Ve(a){let e,t;return{c(){e=c("div"),t=He(a[2]),this.h()},l(l){e=u(l,"DIV",{class:!0});var i=y(e);t=Ae(i,a[2]),i.forEach(d),this.h()},h(){s(e,"class","bg-red-50 text-red-600 p-4 rounded-xl text-sm")},m(l,i){q(l,e,i),r(e,t)},p(l,i){i&4&&Fe(t,l[2])},d(l){l&&d(e)}}}function Ue(a){let e,t="Pay with M-Pesa";return{c(){e=c("span"),e.textContent=t,this.h()},l(l){e=u(l,"SPAN",{class:!0,"data-svelte-h":!0}),D(e)!=="svelte-165xu2f"&&(e.textContent=t),this.h()},h(){s(e,"class","font-medium")},m(l,i){q(l,e,i)},d(l){l&&d(e)}}}function Ke(a){let e,t,l,i,f,g="Processing...";return{c(){e=be("svg"),t=be("circle"),l=be("path"),i=P(),f=c("span"),f.textContent=g,this.h()},l(o){e=me(o,"svg",{class:!0,xmlns:!0,fill:!0,viewBox:!0});var p=y(e);t=me(p,"circle",{class:!0,cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0}),y(t).forEach(d),l=me(p,"path",{class:!0,fill:!0,d:!0}),y(l).forEach(d),p.forEach(d),i=M(o),f=u(o,"SPAN",{"data-svelte-h":!0}),D(f)!=="svelte-ex5vez"&&(f.textContent=g),this.h()},h(){s(t,"class","opacity-25"),s(t,"cx","12"),s(t,"cy","12"),s(t,"r","10"),s(t,"stroke","currentColor"),s(t,"stroke-width","4"),s(l,"class","opacity-75"),s(l,"fill","currentColor"),s(l,"d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"),s(e,"class","animate-spin h-5 w-5"),s(e,"xmlns","http://www.w3.org/2000/svg"),s(e,"fill","none"),s(e,"viewBox","0 0 24 24")},m(o,p){q(o,e,p),r(e,t),r(e,l),q(o,i,p),q(o,f,p)},d(o){o&&(d(e),d(i),d(f))}}}function Le(a){let e,t,l,i,f='<svg class="h-8 w-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>',g,o,p="Payment Initiated!",k,m,V="Please check your phone for the M-Pesa prompt and enter your PIN to complete the donation.",_,b,L="Close",z,O;return{c(){e=c("div"),t=c("div"),l=c("div"),i=c("div"),i.innerHTML=f,g=P(),o=c("h3"),o.textContent=p,k=P(),m=c("p"),m.textContent=V,_=P(),b=c("button"),b.textContent=L,this.h()},l(T){e=u(T,"DIV",{class:!0});var H=y(e);t=u(H,"DIV",{class:!0});var v=y(t);l=u(v,"DIV",{class:!0});var h=y(l);i=u(h,"DIV",{class:!0,"data-svelte-h":!0}),D(i)!=="svelte-iw02p6"&&(i.innerHTML=f),g=M(h),o=u(h,"H3",{class:!0,"data-svelte-h":!0}),D(o)!=="svelte-1t07v3t"&&(o.textContent=p),k=M(h),m=u(h,"P",{class:!0,"data-svelte-h":!0}),D(m)!=="svelte-yf1541"&&(m.textContent=V),_=M(h),b=u(h,"BUTTON",{class:!0,"data-svelte-h":!0}),D(b)!=="svelte-bitcc5"&&(b.textContent=L),h.forEach(d),v.forEach(d),H.forEach(d),this.h()},h(){s(i,"class","mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-green-100 mb-6"),s(o,"class","text-2xl font-bold text-gray-900 mb-2"),s(m,"class","text-gray-600 mb-6"),s(b,"class","w-full inline-flex justify-center px-6 py-3 text-lg font-medium text-blue-600 hover:text-blue-500 transition-colors"),s(l,"class","text-center"),s(t,"class","bg-white rounded-2xl p-8 max-w-md w-full transform transition-all duration-200"),s(e,"class","fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50")},m(T,H){q(T,e,H),r(e,t),r(t,l),r(l,i),r(l,g),r(l,o),r(l,k),r(l,m),r(l,_),r(l,b),z||(O=ee(b,"click",a[10]),z=!0)},p:ge,d(T){T&&d(e),z=!1,O()}}}function Je(a){let e,t,l='<div class="absolute inset-0 bg-hero-pattern bg-cover bg-center bg-fixed"></div> <div class="absolute inset-0 bg-black/30"></div>',i,f,g,o,p,k=`<h1 class="text-3xl font-bold text-gray-800 mb-3">Make a Donation</h1> <p class="text-gray-600 max-w-xl mx-auto">Your contribution helps create positive change in communities.
            Make a secure donation through M-Pesa.</p>`,m,V,_,b,L,z="Amount (KES)",O,T,H,v,h,U,S,K='<span class="text-gray-500 font-medium">KES</span>',Q,N,J,_e='<div class="flex items-center space-x-4"><img src="/images/mpesa-logo.png" alt="M-Pesa Logo" class="h-10"/> <div class="hidden sm:block text-sm text-gray-600">Secure Mobile Payment</div></div> <div class="flex items-center space-x-2 text-green-600"><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path></svg> <span class="text-sm font-medium">Secure</span></div>',ce,F,A,de,W,xe='<span class="text-gray-500 font-medium">+254</span>',fe,Y,ye='<svg class="h-5 w-5 text-gray-400 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span>You&#39;ll receive a payment prompt on your phone. Enter your M-Pesa PIN to complete the donation.</span>',he,se,j,le,re,G,pe,ke,X=Ie(a[6]),C=[];for(let n=0;n<X.length;n+=1)C[n]=De(Te(a,X,n));let E=a[2]&&Ve(a);function we(n,w){return n[1]?Ke:Ue}let ae=we(a),B=ae(a),I=a[5]&&Le(a);return{c(){e=c("div"),t=c("div"),t.innerHTML=l,i=P(),f=c("div"),g=c("div"),o=c("div"),p=c("div"),p.innerHTML=k,m=P(),V=c("div"),_=c("form"),b=c("div"),L=c("label"),L.textContent=z,O=P(),T=c("div");for(let n=0;n<C.length;n+=1)C[n].c();H=P(),v=c("div"),h=c("input"),U=P(),S=c("div"),S.innerHTML=K,Q=P(),N=c("div"),J=c("div"),J.innerHTML=_e,ce=P(),F=c("div"),A=c("input"),de=P(),W=c("div"),W.innerHTML=xe,fe=P(),Y=c("p"),Y.innerHTML=ye,he=P(),E&&E.c(),se=P(),j=c("button"),B.c(),re=P(),I&&I.c(),G=Ee(),this.h()},l(n){e=u(n,"DIV",{class:!0});var w=y(e);t=u(w,"DIV",{class:!0,"data-svelte-h":!0}),D(t)!=="svelte-vqnl64"&&(t.innerHTML=l),i=M(w),f=u(w,"DIV",{class:!0});var x=y(f);g=u(x,"DIV",{class:!0});var te=y(g);o=u(te,"DIV",{class:!0});var ne=y(o);p=u(ne,"DIV",{class:!0,"data-svelte-h":!0}),D(p)!=="svelte-193xecq"&&(p.innerHTML=k),m=M(ne),V=u(ne,"DIV",{class:!0});var Ce=y(V);_=u(Ce,"FORM",{class:!0});var R=y(_);b=u(R,"DIV",{class:!0});var Z=y(b);L=u(Z,"LABEL",{class:!0,"data-svelte-h":!0}),D(L)!=="svelte-qagidu"&&(L.textContent=z),O=M(Z),T=u(Z,"DIV",{class:!0});var Me=y(T);for(let ve=0;ve<C.length;ve+=1)C[ve].l(Me);Me.forEach(d),H=M(Z),v=u(Z,"DIV",{class:!0});var oe=y(v);h=u(oe,"INPUT",{type:!0,class:!0,placeholder:!0,min:!0}),U=M(oe),S=u(oe,"DIV",{class:!0,"data-svelte-h":!0}),D(S)!=="svelte-vo5bb3"&&(S.innerHTML=K),oe.forEach(d),Z.forEach(d),Q=M(R),N=u(R,"DIV",{class:!0});var $=y(N);J=u($,"DIV",{class:!0,"data-svelte-h":!0}),D(J)!=="svelte-a7vsrp"&&(J.innerHTML=_e),ce=M($),F=u($,"DIV",{class:!0});var ie=y(F);A=u(ie,"INPUT",{type:!0,class:!0,placeholder:!0,pattern:!0}),de=M(ie),W=u(ie,"DIV",{class:!0,"data-svelte-h":!0}),D(W)!=="svelte-a8b6ie"&&(W.innerHTML=xe),ie.forEach(d),fe=M($),Y=u($,"P",{class:!0,"data-svelte-h":!0}),D(Y)!=="svelte-qoq85i"&&(Y.innerHTML=ye),$.forEach(d),he=M(R),E&&E.l(R),se=M(R),j=u(R,"BUTTON",{type:!0,class:!0});var Pe=y(j);B.l(Pe),Pe.forEach(d),R.forEach(d),Ce.forEach(d),ne.forEach(d),te.forEach(d),x.forEach(d),w.forEach(d),re=M(n),I&&I.l(n),G=Ee(),this.h()},h(){s(t,"class","fixed inset-0 z-0"),s(p,"class","px-8 pt-12 pb-8 text-center"),s(L,"class","block text-sm font-medium text-gray-700"),s(T,"class","grid grid-cols-3 sm:grid-cols-5 gap-2"),s(h,"type","number"),s(h,"class","w-full h-12 pl-16 pr-4 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-800 svelte-7dlrid"),s(h,"placeholder","Custom amount"),s(h,"min","100"),s(S,"class","absolute inset-y-0 left-0 flex items-center pl-4 pointer-events-none"),s(v,"class","relative mt-4"),s(b,"class","space-y-3"),s(J,"class","flex items-center justify-between"),s(A,"type","tel"),A.required=!0,s(A,"class","w-full h-12 pl-20 pr-4 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-800"),s(A,"placeholder","712 345 678"),s(A,"pattern","[0-9]9"),s(W,"class","absolute inset-y-0 left-0 flex items-center pl-4 pointer-events-none"),s(F,"class","relative"),s(Y,"class","text-sm text-gray-500 flex items-start space-x-2"),s(N,"class","bg-gradient-to-r from-red-50 to-white rounded-xl p-6 space-y-4"),s(j,"type","submit"),s(j,"class","w-full h-14 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl hover:from-blue-700 hover:to-blue-800 transition-all duration-200 flex items-center justify-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg"),j.disabled=le=a[1]||!a[3]&&!a[4]||!a[0],s(_,"class","space-y-8"),s(V,"class","px-8 pb-12"),s(o,"class","bg-white/95 backdrop-blur-sm rounded-[2rem] shadow-2xl overflow-hidden border border-gray-100"),s(g,"class","max-w-3xl mx-auto"),s(f,"class","relative z-10 py-16 px-4 sm:px-6 lg:px-8"),s(e,"class","min-h-screen relative")},m(n,w){q(n,e,w),r(e,t),r(e,i),r(e,f),r(f,g),r(g,o),r(o,p),r(o,m),r(o,V),r(V,_),r(_,b),r(b,L),r(b,O),r(b,T);for(let x=0;x<C.length;x+=1)C[x]&&C[x].m(T,null);r(b,H),r(b,v),r(v,h),ue(h,a[4]),r(v,U),r(v,S),r(_,Q),r(_,N),r(N,J),r(N,ce),r(N,F),r(F,A),ue(A,a[0]),r(F,de),r(F,W),r(N,fe),r(N,Y),r(_,he),E&&E.m(_,null),r(_,se),r(_,j),B.m(j,null),q(n,re,w),I&&I.m(n,w),q(n,G,w),pe||(ke=[ee(h,"input",a[12]),ee(h,"input",a[8]),ee(A,"input",a[13]),ee(_,"submit",Oe(a[9]))],pe=!0)},p(n,[w]){if(w&200){X=Ie(n[6]);let x;for(x=0;x<X.length;x+=1){const te=Te(n,X,x);C[x]?C[x].p(te,w):(C[x]=De(te),C[x].c(),C[x].m(T,null))}for(;x<C.length;x+=1)C[x].d(1);C.length=X.length}w&16&&Se(h.value)!==n[4]&&ue(h,n[4]),w&1&&ue(A,n[0]),n[2]?E?E.p(n,w):(E=Ve(n),E.c(),E.m(_,se)):E&&(E.d(1),E=null),ae!==(ae=we(n))&&(B.d(1),B=ae(n),B&&(B.c(),B.m(j,null))),w&27&&le!==(le=n[1]||!n[3]&&!n[4]||!n[0])&&(j.disabled=le),n[5]?I?I.p(n,w):(I=Le(n),I.c(),I.m(G.parentNode,G)):I&&(I.d(1),I=null)},i:ge,o:ge,d(n){n&&(d(e),d(re),d(G)),Be(C,n),E&&E.d(),B.d(),I&&I.d(n),pe=!1,ze(ke)}}}function We(a){return/^(?:254|\+254|0)?([71](?:(?:[0-9][0-9])|(?:0[0-8]))[0-9]{6})$/.test(a)}function Ye(a){const e=a.replace(/\D/g,"");return e.startsWith("0")?"254"+e.slice(1):e.startsWith("254")?e:"254"+e}function Qe(a,e,t){let l="",i=!1,f="",g="",o="",p="",k=!1;const m=[{value:500,label:"500"},{value:1e3,label:"1,000"},{value:2500,label:"2,500"},{value:5e3,label:"5,000"},{value:1e4,label:"10,000"}];function V(v){t(3,o=v.toString()),t(4,p="")}function _(v){t(3,o=""),t(4,p=v.target.value)}async function b(){const v=o||p;if(!v||!l){t(2,f="Please fill in all required fields");return}if(!We(l)){t(2,f="Please enter a valid Kenyan phone number");return}t(1,i=!0),t(2,f=""),g="";try{const h=await fetch("/api/mpesa/stkpush",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:parseFloat(v),phoneNumber:Ye(l)})});if(!h.ok){const S=await h.json();throw new Error(S.error||"Failed to process payment")}const U=await h.json();g="Please check your phone for the M-Pesa prompt to complete the payment.",t(5,k=!0),L(U.checkoutRequestId)}catch(h){t(2,f=h.message||"Failed to process payment. Please try again.")}finally{t(1,i=!1)}}async function L(v){let U=0;const S=async()=>{try{const K=await fetch(`/api/mpesa/status/${v}`);if(!K.ok)throw new Error("Failed to check payment status");const Q=await K.json();if(Q.status==="COMPLETED"){Re("/thank-you");return}if(Q.status==="FAILED"){t(2,f="Payment failed. Please try again.");return}++U<10&&setTimeout(S,5e3)}catch(K){console.error("Error checking payment status:",K)}};S()}function z(){t(5,k=!1)}const O=v=>V(v.value);function T(){p=Se(this.value),t(4,p)}function H(){l=this.value,t(0,l)}return[l,i,f,o,p,k,m,V,_,b,z,O,T,H]}class et extends Ne{constructor(e){super(),je(this,e,Qe,Je,qe,{})}}export{et as component};
