import{s as at,n as He,o as nt,r as it}from"../chunks/tX34NKkc.js";import{S as dt,i as ct,d as u,a as H,b as r,c as a,v as ut,h as y,e as d,f as _,j as S,l as x,k as c,r as st,s as $,g as j,t as L,m as ht,w as $e,q as we,p as ye,u as ft}from"../chunks/C0-Udht3.js";import{e as et}from"../chunks/D6YF6ztN.js";function tt(o,e,t){const l=o.slice();return l[12]=e[t],l}function pt(o){let e,t,l,n=o[0].title+"",s,m,h,v,p,f,T=Math.round(o[0].raised_amount/o[0].target_amount*100)+"",b,M,N,w,ee,ae=Be(o[0].target_amount)+"",de,xe,te,U,Ee,re,ne=o[0].description+"",ce,Ce,R,ze=`<h3 class="font-semibold text-ochre-900 mb-2">About This Project</h3> <ul class="space-y-2 text-sm text-gray-600"><li class="flex items-center"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-green-500 mr-2" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>
                100% of donations go directly to the project</li> <li class="flex items-center"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-green-500 mr-2" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>
                Secure M-Pesa payment</li> <li class="flex items-center"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-green-500 mr-2" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>
                Regular project updates</li></ul>`,ke,q,G,Ke="Make Your Donation",Pe,C,B,J,qe="Select Amount (KES)",Xe,Y,Me,F,Q,Fe="KES",De,V,Ie,z,O,Oe="M-Pesa Phone Number",je,D,Le,W,Ue="Format: 254XXXXXXXXX (Kenyan numbers only)",Ne,ue,he,A,fe,Ve,Z,Re="By donating, you agree to our terms of service and privacy policy.",Se,Ge,le=et(o[6]),k=[];for(let i=0;i<le.length;i+=1)k[i]=rt(tt(o,le,i));let P=o[4]&&lt(o),X=o[5]&&ot(o);function Je(i,E){return i[3].donation?_t:gt}let pe=Je(o),K=pe(o);return{c(){e=c("div"),t=c("div"),l=c("h1"),s=L(n),m=x(),h=c("div"),v=c("div"),p=c("span"),f=L("Progress: "),b=L(T),M=L("%"),N=x(),w=c("span"),ee=L("Goal: "),de=L(ae),xe=x(),te=c("div"),U=c("div"),Ee=x(),re=c("p"),ce=L(ne),Ce=x(),R=c("div"),R.innerHTML=ze,ke=x(),q=c("div"),G=c("h2"),G.textContent=Ke,Pe=x(),C=c("form"),B=c("div"),J=c("label"),J.textContent=qe,Xe=x(),Y=c("div");for(let i=0;i<k.length;i+=1)k[i].c();Me=x(),F=c("div"),Q=c("span"),Q.textContent=Fe,De=x(),V=c("input"),Ie=x(),z=c("div"),O=c("label"),O.textContent=Oe,je=x(),D=c("input"),Le=x(),W=c("p"),W.textContent=Ue,Ne=x(),P&&P.c(),ue=x(),X&&X.c(),he=x(),A=c("button"),K.c(),Ve=x(),Z=c("p"),Z.textContent=Re,this.h()},l(i){e=d(i,"DIV",{class:!0});var E=_(e);t=d(E,"DIV",{class:!0});var g=_(t);l=d(g,"H1",{class:!0});var ie=_(l);s=j(ie,n),ie.forEach(u),m=y(g),h=d(g,"DIV",{class:!0});var me=_(h);v=d(me,"DIV",{class:!0});var ve=_(v);p=d(ve,"SPAN",{});var ge=_(p);f=j(ge,"Progress: "),b=j(ge,T),M=j(ge,"%"),ge.forEach(u),N=y(ve),w=d(ve,"SPAN",{});var Te=_(w);ee=j(Te,"Goal: "),de=j(Te,ae),Te.forEach(u),ve.forEach(u),xe=y(me),te=d(me,"DIV",{class:!0});var Ye=_(te);U=d(Ye,"DIV",{class:!0,style:!0}),_(U).forEach(u),Ye.forEach(u),me.forEach(u),Ee=y(g),re=d(g,"P",{class:!0});var Qe=_(re);ce=j(Qe,ne),Qe.forEach(u),Ce=y(g),R=d(g,"DIV",{class:!0,"data-svelte-h":!0}),S(R)!=="svelte-109dp98"&&(R.innerHTML=ze),g.forEach(u),ke=y(E),q=d(E,"DIV",{class:!0});var _e=_(q);G=d(_e,"H2",{class:!0,"data-svelte-h":!0}),S(G)!=="svelte-1woxdh0"&&(G.textContent=Ke),Pe=y(_e),C=d(_e,"FORM",{class:!0});var I=_(C);B=d(I,"DIV",{});var oe=_(B);J=d(oe,"LABEL",{class:!0,"data-svelte-h":!0}),S(J)!=="svelte-1iepysv"&&(J.textContent=qe),Xe=y(oe),Y=d(oe,"DIV",{class:!0});var We=_(Y);for(let Ae=0;Ae<k.length;Ae+=1)k[Ae].l(We);We.forEach(u),Me=y(oe),F=d(oe,"DIV",{class:!0});var be=_(F);Q=d(be,"SPAN",{class:!0,"data-svelte-h":!0}),S(Q)!=="svelte-au6c7g"&&(Q.textContent=Fe),De=y(be),V=d(be,"INPUT",{type:!0,placeholder:!0,class:!0,min:!0}),be.forEach(u),oe.forEach(u),Ie=y(I),z=d(I,"DIV",{});var se=_(z);O=d(se,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),S(O)!=="svelte-8yddn7"&&(O.textContent=Oe),je=y(se),D=d(se,"INPUT",{type:!0,id:!0,placeholder:!0,class:!0,pattern:!0}),Le=y(se),W=d(se,"P",{class:!0,"data-svelte-h":!0}),S(W)!=="svelte-73ed5y"&&(W.textContent=Ue),se.forEach(u),Ne=y(I),P&&P.l(I),ue=y(I),X&&X.l(I),he=y(I),A=d(I,"BUTTON",{type:!0,class:!0});var Ze=_(A);K.l(Ze),Ze.forEach(u),Ve=y(I),Z=d(I,"P",{class:!0,"data-svelte-h":!0}),S(Z)!=="svelte-oui5co"&&(Z.textContent=Re),I.forEach(u),_e.forEach(u),E.forEach(u),this.h()},h(){a(l,"class","text-3xl font-display font-bold text-ochre-900 mb-6"),a(v,"class","flex justify-between text-sm text-gray-600 mb-2"),a(U,"class","h-full bg-gradient-to-r from-ochre-500 to-ochre-600 rounded-full transition-all duration-500"),$e(U,"width",o[0].raised_amount/o[0].target_amount*100+"%"),a(te,"class","h-2 bg-ochre-100 rounded-full overflow-hidden"),a(h,"class","mb-8"),a(re,"class","text-gray-600 mb-6"),a(R,"class","p-4 bg-warmth-100 rounded-xl"),a(t,"class","bg-white rounded-2xl shadow-xl p-8 order-2 lg:order-1"),a(G,"class","text-2xl font-display font-bold text-ochre-900 mb-6"),a(J,"class","block text-sm font-medium text-gray-700 mb-1"),a(Y,"class","grid grid-cols-2 gap-2 mb-2"),a(Q,"class","absolute left-4 top-1/2 -translate-y-1/2 text-gray-500"),a(V,"type","number"),a(V,"placeholder","Enter custom amount"),a(V,"class","w-full pl-16 pr-4 py-2 border-2 border-gray-200 rounded-lg focus:ring-ochre-500 focus:border-ochre-500"),a(V,"min","1"),a(F,"class","relative"),a(O,"for","phone"),a(O,"class","block text-sm font-medium text-gray-700 mb-1"),a(D,"type","tel"),a(D,"id","phone"),a(D,"placeholder","254XXXXXXXXX"),a(D,"class","w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:ring-ochre-500 focus:border-ochre-500"),a(D,"pattern","^254[0-9]9$"),D.required=!0,a(W,"class","mt-1 text-sm text-gray-500"),a(A,"type","submit"),a(A,"class","w-full py-3 px-6 bg-gradient-to-r from-green-600 to-green-500 text-white font-semibold rounded-xl hover:from-green-700 hover:to-green-600 transform hover:scale-[1.02] transition-all duration-300 shadow-lg hover:shadow-xl disabled:opacity-50 disabled:transform-none disabled:hover:shadow-lg"),A.disabled=fe=o[3].donation,a(Z,"class","text-center text-sm text-gray-500 mt-4"),a(C,"class","space-y-6"),a(q,"class","bg-white rounded-2xl shadow-xl p-8 order-1 lg:order-2"),a(e,"class","grid grid-cols-1 lg:grid-cols-2 gap-8")},m(i,E){H(i,e,E),r(e,t),r(t,l),r(l,s),r(t,m),r(t,h),r(h,v),r(v,p),r(p,f),r(p,b),r(p,M),r(v,N),r(v,w),r(w,ee),r(w,de),r(h,xe),r(h,te),r(te,U),r(t,Ee),r(t,re),r(re,ce),r(t,Ce),r(t,R),r(e,ke),r(e,q),r(q,G),r(q,Pe),r(q,C),r(C,B),r(B,J),r(B,Xe),r(B,Y);for(let g=0;g<k.length;g+=1)k[g]&&k[g].m(Y,null);r(B,Me),r(B,F),r(F,Q),r(F,De),r(F,V),we(V,o[1]),r(C,Ie),r(C,z),r(z,O),r(z,je),r(z,D),we(D,o[2]),r(z,Le),r(z,W),r(C,Ne),P&&P.m(C,null),r(C,ue),X&&X.m(C,null),r(C,he),r(C,A),K.m(A,null),r(C,Ve),r(C,Z),Se||(Ge=[ye(V,"input",o[10]),ye(D,"input",o[11]),ye(C,"submit",ft(o[7]))],Se=!0)},p(i,E){if(E&1&&n!==(n=i[0].title+"")&&$(s,n),E&1&&T!==(T=Math.round(i[0].raised_amount/i[0].target_amount*100)+"")&&$(b,T),E&1&&ae!==(ae=Be(i[0].target_amount)+"")&&$(de,ae),E&1&&$e(U,"width",i[0].raised_amount/i[0].target_amount*100+"%"),E&1&&ne!==(ne=i[0].description+"")&&$(ce,ne),E&66){le=et(i[6]);let g;for(g=0;g<le.length;g+=1){const ie=tt(i,le,g);k[g]?k[g].p(ie,E):(k[g]=rt(ie),k[g].c(),k[g].m(Y,null))}for(;g<k.length;g+=1)k[g].d(1);k.length=le.length}E&2&&st(V.value)!==i[1]&&we(V,i[1]),E&4&&we(D,i[2]),i[4]?P?P.p(i,E):(P=lt(i),P.c(),P.m(C,ue)):P&&(P.d(1),P=null),i[5]?X?X.p(i,E):(X=ot(i),X.c(),X.m(C,he)):X&&(X.d(1),X=null),pe!==(pe=Je(i))&&(K.d(1),K=pe(i),K&&(K.c(),K.m(A,null))),E&8&&fe!==(fe=i[3].donation)&&(A.disabled=fe)},d(i){i&&u(e),ht(k,i),P&&P.d(),X&&X.d(),K.d(),Se=!1,it(Ge)}}}function mt(o){let e,t,l,n,s,m="Return Home";return{c(){e=c("div"),t=c("p"),l=L(o[4]),n=x(),s=c("a"),s.textContent=m,this.h()},l(h){e=d(h,"DIV",{class:!0});var v=_(e);t=d(v,"P",{class:!0});var p=_(t);l=j(p,o[4]),p.forEach(u),n=y(v),s=d(v,"A",{href:!0,class:!0,"data-svelte-h":!0}),S(s)!=="svelte-bgrp9g"&&(s.textContent=m),v.forEach(u),this.h()},h(){a(t,"class","text-red-600"),a(s,"href","/"),a(s,"class","mt-4 inline-block px-6 py-2 bg-red-100 text-red-700 rounded-full hover:bg-red-200 transition-colors"),a(e,"class","bg-red-50 border border-red-200 rounded-lg p-6 text-center")},m(h,v){H(h,e,v),r(e,t),r(t,l),r(e,n),r(e,s)},p(h,v){v&16&&$(l,h[4])},d(h){h&&u(e)}}}function vt(o){let e,t='<div class="animate-spin rounded-full h-16 w-16 border-4 border-ochre-500 border-t-transparent"></div>';return{c(){e=c("div"),e.innerHTML=t,this.h()},l(l){e=d(l,"DIV",{class:!0,"data-svelte-h":!0}),S(e)!=="svelte-12sj9b"&&(e.innerHTML=t),this.h()},h(){a(e,"class","flex justify-center items-center min-h-[400px]")},m(l,n){H(l,e,n)},p:He,d(l){l&&u(e)}}}function rt(o){let e,t=Be(o[12])+"",l,n,s,m,h;function v(){return o[9](o[12])}return{c(){e=c("button"),l=L(t),n=x(),this.h()},l(p){e=d(p,"BUTTON",{type:!0,class:!0});var f=_(e);l=j(f,t),n=y(f),f.forEach(u),this.h()},h(){a(e,"type","button"),a(e,"class",s="px-4 py-2 border-2 rounded-lg text-center transition-colors "+(o[1]===String(o[12])?"border-ochre-500 bg-ochre-50 text-ochre-700":"border-gray-200 hover:border-ochre-200 text-gray-600 hover:bg-warmth-100"))},m(p,f){H(p,e,f),r(e,l),r(e,n),m||(h=ye(e,"click",v),m=!0)},p(p,f){o=p,f&2&&s!==(s="px-4 py-2 border-2 rounded-lg text-center transition-colors "+(o[1]===String(o[12])?"border-ochre-500 bg-ochre-50 text-ochre-700":"border-gray-200 hover:border-ochre-200 text-gray-600 hover:bg-warmth-100"))&&a(e,"class",s)},d(p){p&&u(e),m=!1,h()}}}function lt(o){let e,t,l;return{c(){e=c("div"),t=c("p"),l=L(o[4]),this.h()},l(n){e=d(n,"DIV",{class:!0});var s=_(e);t=d(s,"P",{class:!0});var m=_(t);l=j(m,o[4]),m.forEach(u),s.forEach(u),this.h()},h(){a(t,"class","text-red-600"),a(e,"class","p-4 bg-red-50 border border-red-200 rounded-lg")},m(n,s){H(n,e,s),r(e,t),r(t,l)},p(n,s){s&16&&$(l,n[4])},d(n){n&&u(e)}}}function ot(o){let e,t,l;return{c(){e=c("div"),t=c("p"),l=L(o[5]),this.h()},l(n){e=d(n,"DIV",{class:!0});var s=_(e);t=d(s,"P",{class:!0});var m=_(t);l=j(m,o[5]),m.forEach(u),s.forEach(u),this.h()},h(){a(t,"class","text-green-600"),a(e,"class","p-4 bg-green-50 border border-green-200 rounded-lg")},m(n,s){H(n,e,s),r(e,t),r(t,l)},p(n,s){s&32&&$(l,n[5])},d(n){n&&u(e)}}}function gt(o){let e;return{c(){e=L("Donate via M-Pesa")},l(t){e=j(t,"Donate via M-Pesa")},m(t,l){H(t,e,l)},d(t){t&&u(e)}}}function _t(o){let e,t=`<svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>
                  Processing...`;return{c(){e=c("span"),e.innerHTML=t,this.h()},l(l){e=d(l,"SPAN",{class:!0,"data-svelte-h":!0}),S(e)!=="svelte-1qzctu9"&&(e.innerHTML=t),this.h()},h(){a(e,"class","flex items-center justify-center")},m(l,n){H(l,e,n)},d(l){l&&u(e)}}}function bt(o){var T;let e,t,l,n,s,m=`<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 transform group-hover:-translate-x-1 transition-transform" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path></svg>
      Back to Projects`,h;document.title=e="Donate - "+(((T=o[0])==null?void 0:T.title)||"Loading...");function v(b,M){if(b[3].project)return vt;if(b[4]&&!b[0])return mt;if(b[0])return pt}let p=v(o),f=p&&p(o);return{c(){t=x(),l=c("main"),n=c("div"),s=c("a"),s.innerHTML=m,h=x(),f&&f.c(),this.h()},l(b){ut("svelte-47a4mf",document.head).forEach(u),t=y(b),l=d(b,"MAIN",{class:!0});var N=_(l);n=d(N,"DIV",{class:!0});var w=_(n);s=d(w,"A",{href:!0,class:!0,"data-svelte-h":!0}),S(s)!=="svelte-1hncha7"&&(s.innerHTML=m),h=y(w),f&&f.l(w),w.forEach(u),N.forEach(u),this.h()},h(){a(s,"href","/"),a(s,"class","inline-flex items-center text-ochre-600 hover:text-ochre-700 mb-8 group"),a(n,"class","container mx-auto px-4 max-w-4xl"),a(l,"class","min-h-screen bg-gradient-to-b from-warmth-100 to-white py-12")},m(b,M){H(b,t,M),H(b,l,M),r(l,n),r(n,s),r(n,h),f&&f.m(n,null)},p(b,[M]){var N;M&1&&e!==(e="Donate - "+(((N=b[0])==null?void 0:N.title)||"Loading..."))&&(document.title=e),p===(p=v(b))&&f?f.p(b,M):(f&&f.d(1),f=p&&p(b),f&&(f.c(),f.m(n,null)))},i:He,o:He,d(b){b&&(u(t),u(l)),f&&f.d()}}}function Be(o){return new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(o)}function wt(o,e,t){let{data:l}=e,n=null,s="",m="",h={project:!0,donation:!1},v="",p="";nt(async()=>{try{const w=await fetch(`/api/projects/${l.id}`);if(!w.ok)throw new Error("Project not found");t(0,n=await w.json())}catch(w){t(4,v=w.message||"Failed to load project details")}finally{t(3,h.project=!1,h)}});const f=[1e3,2e3,5e3,1e4];async function T(){t(3,h.donation=!0,h),t(4,v=""),t(5,p="");try{if(!s||isNaN(Number(s))||Number(s)<=0)throw new Error("Please enter a valid amount");if(!m||!/^254[0-9]{9}$/.test(m))throw new Error("Please enter a valid Kenyan phone number (format: 254XXXXXXXXX)");const ee=await(await fetch("/api/donate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:l.id,amount:Number(s),phoneNumber:m})})).json();if(!ee.success)throw new Error(ee.error||"Failed to process donation");t(5,p="Payment request sent! Please check your phone to complete the M-Pesa payment."),t(1,s=""),t(2,m="")}catch(w){t(4,v=w.message||"An error occurred while processing your donation")}finally{t(3,h.donation=!1,h)}}const b=w=>t(1,s=String(w));function M(){s=st(this.value),t(1,s)}function N(){m=this.value,t(2,m)}return o.$$set=w=>{"data"in w&&t(8,l=w.data)},[n,s,m,h,v,p,f,T,l,b,M,N]}class Ct extends dt{constructor(e){super(),ct(this,e,wt,bt,at,{data:8})}}export{Ct as component};
