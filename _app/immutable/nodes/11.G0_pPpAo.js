import{S as Ne,i as qe,s as ze,n as ge,d,q as Be,z as Oe,B as Se,A as ue,b as q,c as r,y as ee,C as Fe,e as s,f as u,g as _,k as D,j as M,J as Ee,l as c,m as P,E as Re,Q as Ue,h as Ae,t as je,a as Ke,R as ve,T as be}from"../chunks/C7Wb-gAW.js";import{e as Ie}from"../chunks/D6YF6ztN.js";import"../chunks/IHki7fMi.js";import{base as He}from"../chunks/DN62ret_.js";import{g as Je}from"../chunks/Dh2f7bSz.js";function Te(n,e,t){const l=n.slice();return l[16]=e[t],l}function De(n){let e,t=n[16].label+"",l,i,f,g,o;function p(){return n[11](n[16])}return{c(){e=c("button"),l=je(t),i=P(),this.h()},l(k){e=u(k,"BUTTON",{type:!0,class:!0});var v=_(e);l=Ae(v,t),i=M(v),v.forEach(d),this.h()},h(){s(e,"type","button"),s(e,"class",f="relative h-12 rounded-xl text-center transition-all duration-200 "+(n[3]===n[16].value.toString()?"bg-blue-600 text-white font-medium shadow-lg scale-105":"bg-gray-50 text-gray-600 hover:bg-gray-100"))},m(k,v){q(k,e,v),r(e,l),r(e,i),g||(o=ee(e,"click",p),g=!0)},p(k,v){n=k,v&8&&f!==(f="relative h-12 rounded-xl text-center transition-all duration-200 "+(n[3]===n[16].value.toString()?"bg-blue-600 text-white font-medium shadow-lg scale-105":"bg-gray-50 text-gray-600 hover:bg-gray-100"))&&s(e,"class",f)},d(k){k&&d(e),g=!1,o()}}}function Ve(n){let e,t;return{c(){e=c("div"),t=je(n[2]),this.h()},l(l){e=u(l,"DIV",{class:!0});var i=_(e);t=Ae(i,n[2]),i.forEach(d),this.h()},h(){s(e,"class","bg-red-50 text-red-600 p-4 rounded-xl text-sm")},m(l,i){q(l,e,i),r(e,t)},p(l,i){i&4&&Ke(t,l[2])},d(l){l&&d(e)}}}function We(n){let e,t="Pay with M-Pesa";return{c(){e=c("span"),e.textContent=t,this.h()},l(l){e=u(l,"SPAN",{class:!0,"data-svelte-h":!0}),D(e)!=="svelte-165xu2f"&&(e.textContent=t),this.h()},h(){s(e,"class","font-medium")},m(l,i){q(l,e,i)},d(l){l&&d(e)}}}function Ye(n){let e,t,l,i,f,g="Processing...";return{c(){e=be("svg"),t=be("circle"),l=be("path"),i=P(),f=c("span"),f.textContent=g,this.h()},l(o){e=ve(o,"svg",{class:!0,xmlns:!0,fill:!0,viewBox:!0});var p=_(e);t=ve(p,"circle",{class:!0,cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0}),_(t).forEach(d),l=ve(p,"path",{class:!0,fill:!0,d:!0}),_(l).forEach(d),p.forEach(d),i=M(o),f=u(o,"SPAN",{"data-svelte-h":!0}),D(f)!=="svelte-ex5vez"&&(f.textContent=g),this.h()},h(){s(t,"class","opacity-25"),s(t,"cx","12"),s(t,"cy","12"),s(t,"r","10"),s(t,"stroke","currentColor"),s(t,"stroke-width","4"),s(l,"class","opacity-75"),s(l,"fill","currentColor"),s(l,"d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"),s(e,"class","animate-spin h-5 w-5"),s(e,"xmlns","http://www.w3.org/2000/svg"),s(e,"fill","none"),s(e,"viewBox","0 0 24 24")},m(o,p){q(o,e,p),r(e,t),r(e,l),q(o,i,p),q(o,f,p)},d(o){o&&(d(e),d(i),d(f))}}}function Le(n){let e,t,l,i,f='<svg class="h-8 w-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>',g,o,p="Payment Initiated!",k,v,V="Please check your phone for the M-Pesa prompt and enter your PIN to complete the donation.",y,b,L="Close",B,O;return{c(){e=c("div"),t=c("div"),l=c("div"),i=c("div"),i.innerHTML=f,g=P(),o=c("h3"),o.textContent=p,k=P(),v=c("p"),v.textContent=V,y=P(),b=c("button"),b.textContent=L,this.h()},l(T){e=u(T,"DIV",{class:!0});var j=_(e);t=u(j,"DIV",{class:!0});var m=_(t);l=u(m,"DIV",{class:!0});var h=_(l);i=u(h,"DIV",{class:!0,"data-svelte-h":!0}),D(i)!=="svelte-iw02p6"&&(i.innerHTML=f),g=M(h),o=u(h,"H3",{class:!0,"data-svelte-h":!0}),D(o)!=="svelte-1t07v3t"&&(o.textContent=p),k=M(h),v=u(h,"P",{class:!0,"data-svelte-h":!0}),D(v)!=="svelte-yf1541"&&(v.textContent=V),y=M(h),b=u(h,"BUTTON",{class:!0,"data-svelte-h":!0}),D(b)!=="svelte-bitcc5"&&(b.textContent=L),h.forEach(d),m.forEach(d),j.forEach(d),this.h()},h(){s(i,"class","mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-green-100 mb-6"),s(o,"class","text-2xl font-bold text-gray-900 mb-2"),s(v,"class","text-gray-600 mb-6"),s(b,"class","w-full inline-flex justify-center px-6 py-3 text-lg font-medium text-blue-600 hover:text-blue-500 transition-colors"),s(l,"class","text-center"),s(t,"class","bg-white rounded-2xl p-8 max-w-md w-full transform transition-all duration-200"),s(e,"class","fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50")},m(T,j){q(T,e,j),r(e,t),r(t,l),r(l,i),r(l,g),r(l,o),r(l,k),r(l,v),r(l,y),r(l,b),B||(O=ee(b,"click",n[10]),B=!0)},p:ge,d(T){T&&d(e),B=!1,O()}}}function Qe(n){let e,t,l='<div class="absolute inset-0 bg-hero-pattern bg-cover bg-center bg-fixed"></div> <div class="absolute inset-0 bg-black/30"></div>',i,f,g,o,p,k=`<h1 class="text-3xl font-bold text-gray-800 mb-3">Make a Donation</h1> <p class="text-gray-600 max-w-xl mx-auto">Your contribution helps create positive change in communities.
            Make a secure donation through M-Pesa.</p>`,v,V,y,b,L,B="Amount (KES)",O,T,j,m,h,U,S,K='<span class="text-gray-500 font-medium">KES</span>',Q,H,J,ye=`<div class="flex items-center space-x-4"><img src="${He}/images/mpesa-logo.png" alt="M-Pesa Logo" class="h-10"/> <div class="hidden sm:block text-sm text-gray-600">Secure Mobile Payment</div></div> <div class="flex items-center space-x-2 text-green-600"><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path></svg> <span class="text-sm font-medium">Secure</span></div>`,ce,F,A,de,W,xe='<span class="text-gray-500 font-medium">+254</span>',fe,Y,_e='<svg class="h-5 w-5 text-gray-400 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span>You&#39;ll receive a payment prompt on your phone. Enter your M-Pesa PIN to complete the donation.</span>',he,se,N,le,re,G,pe,ke,X=Ie(n[6]),C=[];for(let a=0;a<X.length;a+=1)C[a]=De(Te(n,X,a));let E=n[2]&&Ve(n);function we(a,w){return a[1]?Ye:We}let ne=we(n),z=ne(n),I=n[5]&&Le(n);return{c(){e=c("div"),t=c("div"),t.innerHTML=l,i=P(),f=c("div"),g=c("div"),o=c("div"),p=c("div"),p.innerHTML=k,v=P(),V=c("div"),y=c("form"),b=c("div"),L=c("label"),L.textContent=B,O=P(),T=c("div");for(let a=0;a<C.length;a+=1)C[a].c();j=P(),m=c("div"),h=c("input"),U=P(),S=c("div"),S.innerHTML=K,Q=P(),H=c("div"),J=c("div"),J.innerHTML=ye,ce=P(),F=c("div"),A=c("input"),de=P(),W=c("div"),W.innerHTML=xe,fe=P(),Y=c("p"),Y.innerHTML=_e,he=P(),E&&E.c(),se=P(),N=c("button"),z.c(),re=P(),I&&I.c(),G=Ee(),this.h()},l(a){e=u(a,"DIV",{class:!0});var w=_(e);t=u(w,"DIV",{class:!0,"data-svelte-h":!0}),D(t)!=="svelte-vqnl64"&&(t.innerHTML=l),i=M(w),f=u(w,"DIV",{class:!0});var x=_(f);g=u(x,"DIV",{class:!0});var te=_(g);o=u(te,"DIV",{class:!0});var ae=_(o);p=u(ae,"DIV",{class:!0,"data-svelte-h":!0}),D(p)!=="svelte-193xecq"&&(p.innerHTML=k),v=M(ae),V=u(ae,"DIV",{class:!0});var Ce=_(V);y=u(Ce,"FORM",{class:!0});var R=_(y);b=u(R,"DIV",{class:!0});var Z=_(b);L=u(Z,"LABEL",{class:!0,"data-svelte-h":!0}),D(L)!=="svelte-qagidu"&&(L.textContent=B),O=M(Z),T=u(Z,"DIV",{class:!0});var Me=_(T);for(let me=0;me<C.length;me+=1)C[me].l(Me);Me.forEach(d),j=M(Z),m=u(Z,"DIV",{class:!0});var oe=_(m);h=u(oe,"INPUT",{type:!0,class:!0,placeholder:!0,min:!0}),U=M(oe),S=u(oe,"DIV",{class:!0,"data-svelte-h":!0}),D(S)!=="svelte-vo5bb3"&&(S.innerHTML=K),oe.forEach(d),Z.forEach(d),Q=M(R),H=u(R,"DIV",{class:!0});var $=_(H);J=u($,"DIV",{class:!0,"data-svelte-h":!0}),D(J)!=="svelte-1fdjoqa"&&(J.innerHTML=ye),ce=M($),F=u($,"DIV",{class:!0});var ie=_(F);A=u(ie,"INPUT",{type:!0,class:!0,placeholder:!0,pattern:!0}),de=M(ie),W=u(ie,"DIV",{class:!0,"data-svelte-h":!0}),D(W)!=="svelte-a8b6ie"&&(W.innerHTML=xe),ie.forEach(d),fe=M($),Y=u($,"P",{class:!0,"data-svelte-h":!0}),D(Y)!=="svelte-qoq85i"&&(Y.innerHTML=_e),$.forEach(d),he=M(R),E&&E.l(R),se=M(R),N=u(R,"BUTTON",{type:!0,class:!0});var Pe=_(N);z.l(Pe),Pe.forEach(d),R.forEach(d),Ce.forEach(d),ae.forEach(d),te.forEach(d),x.forEach(d),w.forEach(d),re=M(a),I&&I.l(a),G=Ee(),this.h()},h(){s(t,"class","fixed inset-0 z-0"),s(p,"class","px-8 pt-12 pb-8 text-center"),s(L,"class","block text-sm font-medium text-gray-700"),s(T,"class","grid grid-cols-3 sm:grid-cols-5 gap-2"),s(h,"type","number"),s(h,"class","w-full h-12 pl-16 pr-4 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-800 svelte-1c5xbsj"),s(h,"placeholder","Custom amount"),s(h,"min","100"),s(S,"class","absolute inset-y-0 left-0 flex items-center pl-4 pointer-events-none"),s(m,"class","relative mt-4"),s(b,"class","space-y-3"),s(J,"class","flex items-center justify-between"),s(A,"type","tel"),A.required=!0,s(A,"class","w-full h-12 pl-20 pr-4 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-800"),s(A,"placeholder","712 345 678"),s(A,"pattern","[0-9]9"),s(W,"class","absolute inset-y-0 left-0 flex items-center pl-4 pointer-events-none"),s(F,"class","relative"),s(Y,"class","text-sm text-gray-500 flex items-start space-x-2"),s(H,"class","bg-gradient-to-r from-red-50 to-white rounded-xl p-6 space-y-4"),s(N,"type","submit"),s(N,"class","w-full h-14 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl hover:from-blue-700 hover:to-blue-800 transition-all duration-200 flex items-center justify-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg"),N.disabled=le=n[1]||!n[3]&&!n[4]||!n[0],s(y,"class","space-y-8"),s(V,"class","px-8 pb-12"),s(o,"class","bg-white/95 backdrop-blur-sm rounded-[2rem] shadow-2xl overflow-hidden border border-gray-100"),s(g,"class","max-w-3xl mx-auto"),s(f,"class","relative z-10 py-16 px-4 sm:px-6 lg:px-8"),s(e,"class","min-h-screen relative")},m(a,w){q(a,e,w),r(e,t),r(e,i),r(e,f),r(f,g),r(g,o),r(o,p),r(o,v),r(o,V),r(V,y),r(y,b),r(b,L),r(b,O),r(b,T);for(let x=0;x<C.length;x+=1)C[x]&&C[x].m(T,null);r(b,j),r(b,m),r(m,h),ue(h,n[4]),r(m,U),r(m,S),r(y,Q),r(y,H),r(H,J),r(H,ce),r(H,F),r(F,A),ue(A,n[0]),r(F,de),r(F,W),r(H,fe),r(H,Y),r(y,he),E&&E.m(y,null),r(y,se),r(y,N),z.m(N,null),q(a,re,w),I&&I.m(a,w),q(a,G,w),pe||(ke=[ee(h,"input",n[12]),ee(h,"input",n[8]),ee(A,"input",n[13]),ee(y,"submit",Fe(n[9]))],pe=!0)},p(a,[w]){if(w&200){X=Ie(a[6]);let x;for(x=0;x<X.length;x+=1){const te=Te(a,X,x);C[x]?C[x].p(te,w):(C[x]=De(te),C[x].c(),C[x].m(T,null))}for(;x<C.length;x+=1)C[x].d(1);C.length=X.length}w&16&&Se(h.value)!==a[4]&&ue(h,a[4]),w&1&&ue(A,a[0]),a[2]?E?E.p(a,w):(E=Ve(a),E.c(),E.m(y,se)):E&&(E.d(1),E=null),ne!==(ne=we(a))&&(z.d(1),z=ne(a),z&&(z.c(),z.m(N,null))),w&27&&le!==(le=a[1]||!a[3]&&!a[4]||!a[0])&&(N.disabled=le),a[5]?I?I.p(a,w):(I=Le(a),I.c(),I.m(G.parentNode,G)):I&&(I.d(1),I=null)},i:ge,o:ge,d(a){a&&(d(e),d(re),d(G)),Be(C,a),E&&E.d(),z.d(),I&&I.d(a),pe=!1,Oe(ke)}}}function Ge(n){return/^(?:254|\+254|0)?([71](?:(?:[0-9][0-9])|(?:0[0-8]))[0-9]{6})$/.test(n)}function Xe(n){const e=n.replace(/\D/g,"");return e.startsWith("0")?"254"+e.slice(1):e.startsWith("254")?e:"254"+e}function Ze(n,e,t){let l="",i=!1,f="",g="",o="",p="",k=!1;Re(()=>{document.body.style.backgroundImage=`url('${He}/images/wmremove-transformed.jpeg')`,document.body.style.backgroundSize="cover",document.body.style.backgroundPosition="center",document.body.style.backgroundAttachment="fixed"}),Ue(()=>{document.body.style.backgroundImage="",document.body.style.backgroundSize="",document.body.style.backgroundPosition="",document.body.style.backgroundAttachment=""});const v=[{value:500,label:"500"},{value:1e3,label:"1,000"},{value:2500,label:"2,500"},{value:5e3,label:"5,000"},{value:1e4,label:"10,000"}];function V(m){t(3,o=m.toString()),t(4,p="")}function y(m){t(3,o=""),t(4,p=m.target.value)}async function b(){const m=o||p;if(!m||!l){t(2,f="Please fill in all required fields");return}if(!Ge(l)){t(2,f="Please enter a valid Kenyan phone number");return}t(1,i=!0),t(2,f=""),g="";try{const h=await fetch("/api/mpesa/stkpush",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:parseFloat(m),phoneNumber:Xe(l)})});if(!h.ok){const S=await h.json();throw new Error(S.error||"Failed to process payment")}const U=await h.json();g="Please check your phone for the M-Pesa prompt to complete the payment.",t(5,k=!0),L(U.checkoutRequestId)}catch(h){t(2,f=h.message||"Failed to process payment. Please try again.")}finally{t(1,i=!1)}}async function L(m){let U=0;const S=async()=>{try{const K=await fetch(`/api/mpesa/status/${m}`);if(!K.ok)throw new Error("Failed to check payment status");const Q=await K.json();if(Q.status==="COMPLETED"){Je("/thank-you");return}if(Q.status==="FAILED"){t(2,f="Payment failed. Please try again.");return}++U<10&&setTimeout(S,5e3)}catch(K){console.error("Error checking payment status:",K)}};S()}function B(){t(5,k=!1)}const O=m=>V(m.value);function T(){p=Se(this.value),t(4,p)}function j(){l=this.value,t(0,l)}return[l,i,f,o,p,k,v,V,y,b,B,O,T,j]}class rt extends Ne{constructor(e){super(),qe(this,e,Ze,Qe,ze,{})}}export{rt as component};
